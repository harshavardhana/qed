"use strict";var FontInspector=(function FontInspectorClosure(){var h;var e=false;var f="data-font-name";function g(){var m=document.querySelectorAll("div["+f+"]");for(var k=0,l=m.length;k<l;++k){var n=m[k];n.className=""}}function i(){var m=document.querySelectorAll("div["+f+"]");for(var k=0,l=m.length;k<l;++k){var n=m[k];n.className="debuggerHideText"}}function d(o,k){var n=document.querySelectorAll("div["+f+"="+o+"]");for(var l=0,m=n.length;l<m;++l){var p=n[l];p.className=k?"debuggerShowText":"debuggerHideText"}}function b(o){if(!o.target.dataset.fontName||o.target.tagName.toUpperCase()!=="DIV"){return}var n=o.target.dataset.fontName;var m=document.getElementsByTagName("input");for(var l=0;l<m.length;++l){var k=m[l];if(k.dataset.fontName!=n){continue}k.checked=!k.checked;d(n,k.checked);k.scrollIntoView()}}return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function j(){var k=this.panel;k.setAttribute("style","padding: 5px;");var l=document.createElement("button");l.addEventListener("click",i);l.textContent="Refresh";k.appendChild(l);h=document.createElement("div");k.appendChild(h)},cleanup:function c(){h.textContent=""},enabled:false,get efunction(){return e},set efunction(k){e=k;if(e){document.body.addEventListener("click",b,true);i()}else{document.body.removeEventListener("click",b,true);g()}},fontAdded:function a(v,n){function t(B,A){var m=document.createElement("table");for(var x=0;x<A.length;x++){var z=document.createElement("tr");var y=document.createElement("td");y.textContent=A[x];z.appendChild(y);var w=document.createElement("td");w.textContent=B[A[x]].toString();z.appendChild(w);m.appendChild(z)}return m}var r=t(v,["name","type"]);var q=/url\(['"]?([^\)"']+)/.exec(n);var l=v.loadedName;var p=document.createElement("div");var o=document.createElement("span");o.textContent=l;var k=document.createElement("a");k.href=q[1];k.textContent="Download";var s=document.createElement("a");s.href="";s.textContent="Log";s.addEventListener("click",function(m){m.preventDefault();console.log(v)});var u=document.createElement("input");u.setAttribute("type","checkbox");u.dataset.fontName=l;u.addEventListener("click",(function(m,w){return(function(){d(w,m.checked)})})(u,l));p.appendChild(u);p.appendChild(o);p.appendChild(document.createTextNode(" "));p.appendChild(k);p.appendChild(document.createTextNode(" "));p.appendChild(s);p.appendChild(r);h.appendChild(p);setTimeout(function(){if(this.active){i()}}.bind(this),2000)}}})();var StepperManager=(function StepperManagerClosure(){var f=[];var j=null;var h=null;var a=null;var e={};return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function i(){var k=this;this.panel.setAttribute("style","padding: 5px;");h=document.createElement("div");a=document.createElement("select");a.addEventListener("change",function(l){k.selectStepper(this.value)});h.appendChild(a);j=document.createElement("div");this.panel.appendChild(h);this.panel.appendChild(j);if(sessionStorage.getItem("pdfjsBreakPoints")){e=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints"))}},cleanup:function b(){a.textContent="";j.textContent="";f=[]},enabled:false,active:false,create:function d(m){var o=document.createElement("div");o.id="stepper"+m;o.setAttribute("hidden",true);o.className="stepper";j.appendChild(o);var l=document.createElement("option");l.textContent="Page "+(m+1);l.value=m;a.appendChild(l);var n=e[m]||[];var k=new Stepper(o,m,n);f.push(k);if(f.length===1){this.selectStepper(m,false)}return k},selectStepper:function c(l,p){var n;if(p){this.manager.selectPanel(this)}for(n=0;n<f.length;++n){var k=f[n];if(k.pageIndex==l){k.panel.removeAttribute("hidden")}else{k.panel.setAttribute("hidden",true)}}var m=a.options;for(n=0;n<m.length;++n){var o=m[n];o.selected=o.value==l}},saveBreakPoints:function g(k,l){e[k]=l;sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(e))}}})();var Stepper=(function StepperClosure(){function d(c,k){var l=document.createElement(c);if(k){l.textContent=k}return l}var b=null;function h(m){if(typeof m==="string"){var l=75;return m.length<=l?m:m.substr(0,l)+"..."}if(typeof m!=="object"||m===null){return m}if("length" in m){var q=[],o,p;var k=10;for(o=0,p=Math.min(k,m.length);o<p;o++){q.push(h(m[o]))}if(o<m.length){q.push("...")}return q}var c={};for(var n in m){c[n]=h(m[n])}return c}function e(k,c,l){this.panel=k;this.breakPoint=0;this.nextBreakPoint=null;this.pageIndex=c;this.breakPoints=l;this.currentIdx=-1;this.operatorListIdx=0}e.prototype={init:function g(){var c=this.panel;var n=d("div","c=continue, s=step");var m=d("table");n.appendChild(m);m.cellSpacing=0;var l=d("tr");m.appendChild(l);l.appendChild(d("th","Break"));l.appendChild(d("th","Idx"));l.appendChild(d("th","fn"));l.appendChild(d("th","args"));c.appendChild(n);this.table=m;if(!b){b=Object.create(null);for(var k in PDFJS.OPS){b[PDFJS.OPS[k]]=k}}},updateOperatorList:function j(y){var v=this;function o(){var D=+this.dataset.idx;if(this.checked){v.breakPoints.push(D)}else{v.breakPoints.splice(v.breakPoints.indexOf(D),1)}StepperManager.saveBreakPoints(v.pageIndex,v.breakPoints)}var n=15000;if(this.operatorListIdx>n){return}var s=document.createDocumentFragment();var m=Math.min(n,y.fnArray.length);for(var B=this.operatorListIdx;B<m;B++){var r=d("tr");r.className="line";r.dataset.idx=B;s.appendChild(r);var p=this.breakPoints.indexOf(B)!=-1;var c=y.argsArray[B]||[];var z=d("td");var l=d("input");l.type="checkbox";l.className="points";l.checked=p;l.dataset.idx=B;l.onclick=o;z.appendChild(l);r.appendChild(z);r.appendChild(d("td",B.toString()));var q=b[y.fnArray[B]];var C=c;if(q==="showText"){var k=c[0];var u=[];var x=[];for(var A=0;A<k.length;A++){var t=k[A];if(typeof t==="object"&&t!==null){x.push(t.fontChar)}else{if(x.length>0){u.push(x.join(""));x=[]}u.push(t)}}if(x.length>0){u.push(x.join(""))}C=[u]}r.appendChild(d("td",q));r.appendChild(d("td",JSON.stringify(h(C))))}if(m<y.fnArray.length){r=d("tr");var w=d("td","...");w.colspan=4;s.appendChild(w)}this.operatorListIdx=y.fnArray.length;this.table.appendChild(s)},getNextBreakPoint:function f(){this.breakPoints.sort(function(l,k){return l-k});for(var c=0;c<this.breakPoints.length;c++){if(this.breakPoints[c]>this.currentIdx){return this.breakPoints[c]}}return null},breakIt:function i(c,n){StepperManager.selectStepper(this.pageIndex,true);var k=this;var m=document;k.currentIdx=c;var l=function(p){switch(p.keyCode){case 83:m.removeEventListener("keydown",l,false);k.nextBreakPoint=k.currentIdx+1;k.goTo(-1);n();break;case 67:m.removeEventListener("keydown",l,false);var o=k.getNextBreakPoint();k.nextBreakPoint=o;k.goTo(-1);n();break}};m.addEventListener("keydown",l,false);k.goTo(c)},goTo:function a(k){var l=this.panel.getElementsByClassName("line");for(var c=0,n=l.length;c<n;++c){var m=l[c];if(m.dataset.idx==k){m.style.backgroundColor="rgb(251,250,207)";m.scrollIntoView()}else{m.style.backgroundColor=null}}}};return e})();var Stats=(function Stats(){var c=[];function a(e){while(e.hasChildNodes()){e.removeChild(e.lastChild)}}function b(e){for(var f=0,g=c.length;f<g;++f){if(c[f].pageNumber===e){return f}}return false}return{id:"Stats",name:"Stats",panel:null,manager:null,init:function d(){this.panel.setAttribute("style","padding: 5px;");PDFJS.enableStats=true},enabled:false,active:false,add:function(m,g){if(!g){return}var j=b(m);if(j!==false){var k=c[j];this.panel.removeChild(k.div);c.splice(j,1)}var f=document.createElement("div");f.className="stats";var l=document.createElement("div");l.className="title";l.textContent="Page: "+m;var e=document.createElement("div");e.textContent=g.toString();f.appendChild(l);f.appendChild(e);c.push({pageNumber:m,div:f});c.sort(function(o,i){return o.pageNumber-i.pageNumber});a(this.panel);for(var h=0,n=c.length;h<n;++h){this.panel.appendChild(c[h].div)}},cleanup:function(){c=[];a(this.panel)}}})();var PDFBug=(function PDFBugClosure(){var e=300;var b=[];var d=null;return{tools:[FontInspector,StepperManager,Stats],enable:function(k){var j=false,l=this.tools;if(k.length===1&&k[0]==="all"){j=true}for(var h=0;h<l.length;++h){var g=l[h];if(j||k.indexOf(g.id)!==-1){g.enabled=true}}if(!j){l.sort(function(m,i){var o=k.indexOf(m.id);o=o<0?l.length:o;var n=k.indexOf(i.id);n=n<0?l.length:n;return o-n})}},init:function c(){var o=document.createElement("div");o.id="PDFBug";var p=document.createElement("div");p.setAttribute("class","controls");o.appendChild(p);var n=document.createElement("div");n.setAttribute("class","panels");o.appendChild(n);var h=document.getElementById("viewerContainer");h.appendChild(o);h.style.right=e+"px";var l=this.tools;var q=this;for(var k=0;k<l.length;++k){var m=l[k];var g=document.createElement("div");var j=document.createElement("button");j.textContent=m.name;j.addEventListener("click",(function(i){return function(r){r.preventDefault();q.selectPanel(i)}})(k));p.appendChild(j);n.appendChild(g);m.panel=g;m.manager=this;if(m.enabled){m.init()}else{g.textContent=m.name+' is disabled. To enable add  "'+m.id+'" to the pdfBug parameter and refresh (seperate multiple by commas).'}b.push(j)}this.selectPanel(0)},cleanup:function a(){for(var g=0,h=this.tools.length;g<h;g++){if(this.tools[g].enabled){this.tools[g].cleanup()}}},selectPanel:function f(h){if(typeof h!=="number"){h=this.tools.indexOf(h)}if(h===d){return}d=h;var i=this.tools;for(var g=0;g<i.length;++g){if(g==h){b[g].setAttribute("class","active");i[g].active=true;i[g].panel.removeAttribute("hidden")}else{b[g].setAttribute("class","");i[g].active=false;i[g].panel.setAttribute("hidden","true")}}}}})();